<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital Creature</title>

<style>
body{
margin:0;
font-family:sans-serif;
background:#0f172a;
color:white;
text-align:center;
}
.container{padding:15px;}
.card{
background:#1e293b;
padding:20px;
border-radius:20px;
margin-bottom:15px;
transition:0.3s;
}
canvas{
width:180px;
height:180px;
image-rendering:pixelated;
}
.stat{font-size:18px;margin:5px 0;}
button{
width:100%;
padding:15px;
margin:8px 0;
font-size:18px;
border:none;
border-radius:12px;
background:#3b82f6;
color:white;
}
button:active{background:#2563eb;}
.fade{
animation:flash 0.5s alternate 6;
}
@keyframes flash{
from{background:#1e293b;}
to{background:#22c55e;}
}
</style>
</head>

<body>

<div class="container">
<h1>Digital Creature</h1>

<div class="card" id="card">
<canvas id="sprite" width="256" height="256"></canvas>

<div id="stats" style="display:none;">
<div class="stat">Stage: <span id="stage"></span></div>
<div class="stat">Level: <span id="level"></span></div>
<div class="stat">HP: <span id="hp"></span></div>
<div class="stat">Power: <span id="power"></span></div>
<div class="stat">Care: <span id="care"></span></div>
</div>
</div>

<div id="actions" style="display:none;">
<button onclick="feed()">ğŸ– Feed</button>
<button onclick="train()">ğŸ‹ Train</button>
<button onclick="battle()">âš” Battle</button>
<button onclick="resetGame()">ğŸ”„ Reset</button>
</div>

</div>

<script>

/* ===== ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆèª­ã¿è¾¼ã¿ï¼ˆåŒãƒ•ã‚©ãƒ«ãƒ€ï¼‰ ===== */

const img = new Image();
img.src = "./sprite.png"; // â† PNGã®åå‰ã¨ä¸€è‡´ã•ã›ã‚‹

const canvas = document.getElementById("sprite");
const ctx = canvas.getContext("2d");

/* ===== ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ ===== */

let data = JSON.parse(localStorage.getItem("creature")) || {
stage:"Egg",
level:1,
hp:50,
power:10,
care:0,
exp:0,
hatch:0
};

/* ===== ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆä½ç½®ï¼ˆ256x256æƒ³å®šï¼‰ ===== */
/* ä¸Šæ®µ: Egg | Seed | Rookie */
/* ä¸‹æ®µ: --- | Guardian | Berserker */

const spritePos = {
Egg:[0,0],
Seed:[256,0],
Rookie:[512,0],
Guardian:[256,256],
Berserker:[512,256]
};

function draw(){
ctx.clearRect(0,0,256,256);
let pos = spritePos[data.stage];
if(pos){
ctx.drawImage(img,pos[0],pos[1],256,256,0,0,256,256);
}
}

function save(){
localStorage.setItem("creature",JSON.stringify(data));
}

function update(){
draw();

if(data.stage==="Egg"){
card.onclick=()=>{
data.hatch++;
if(data.hatch>=3) hatch();
};
}else{
stats.style.display="block";
actions.style.display="block";
stage.innerText=data.stage;
level.innerText=data.level;
hp.innerText=data.hp;
power.innerText=data.power;
care.innerText=data.care;
}

save();
}

function hatch(){
card.classList.add("fade");
setTimeout(()=>{
data.stage="Seed";
update();
alert("Hatched!");
},800);
}

function feed(){data.hp+=10;data.care++;update();}
function train(){data.power+=2;data.exp+=10;checkEvolution();update();}
function battle(){
let enemy=Math.floor(Math.random()*20)+5;
if(data.power>enemy){alert("Victory!");data.exp+=20;}
else{alert("Defeat...");data.hp-=10;}
checkEvolution();update();
}

function checkEvolution(){
if(data.stage==="Seed"&&data.exp>=30)evolve("Rookie");
else if(data.stage==="Rookie"&&data.exp>=80){
if(data.care>5)evolve("Guardian");
else evolve("Berserker");
}
}

function evolve(newStage){
data.stage=newStage;
data.level++;
card.classList.add("fade");
setTimeout(()=>card.classList.remove("fade"),800);
alert("Evolved to "+newStage+"!");
}

function resetGame(){
localStorage.removeItem("creature");
location.reload();
}

img.onload=update;

</script>

</body>
</html>
