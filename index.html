<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital Creature</title>

<style>
body{
margin:0;
font-family:sans-serif;
background:#0f172a;
color:white;
text-align:center;
}
.container{padding:15px;}
.card{
background:#1e293b;
padding:20px;
border-radius:20px;
margin-bottom:15px;
}
canvas{
width:180px;
height:180px;
image-rendering:pixelated;
background:black;
}
.stat{font-size:18px;margin:5px 0;}
button{
width:100%;
padding:15px;
margin:8px 0;
font-size:18px;
border:none;
border-radius:12px;
background:#3b82f6;
color:white;
}
button:active{background:#2563eb;}
</style>
</head>

<body>

<div class="container">
<h1>Digital Creature</h1>

<div class="card">
<canvas id="sprite"></canvas>

<div id="stats">
<div class="stat">Stage: <span id="stage"></span></div>
<div class="stat">Level: <span id="level"></span></div>
<div class="stat">HP: <span id="hp"></span></div>
<div class="stat">Power: <span id="power"></span></div>
<div class="stat">Care: <span id="care"></span></div>
</div>
</div>

<div>
<button onclick="feed()">ğŸ– Feed</button>
<button onclick="train()">ğŸ‹ Train</button>
<button onclick="resetGame()">ğŸ”„ Reset</button>
</div>

</div>

<script>

/* ===== ç”»åƒèª­ã¿è¾¼ã¿ ===== */
const img = new Image();
img.src = "./sprite.png";

const canvas = document.getElementById("sprite");
const ctx = canvas.getContext("2d");

/* ===== ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆè¨­å®šï¼ˆæ¨ª3 Ã— ç¸¦2ï¼‰===== */
const COLS = 5;
const ROWS = 1;

/* ===== ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿ ===== */
let data = JSON.parse(localStorage.getItem("creature")) || {
stage:"Egg",
level:1,
hp:50,
power:10,
care:0
};

function save(){
localStorage.setItem("creature",JSON.stringify(data));
}

function getStageIndex(){
switch(data.stage){
case "Egg": return 0;
case "Baby": return 1;
case "Rookie": return 2;
case "Knight": return 3;
case "Dragon": return 4;
default: return 0;
}
}

function draw(){

const index = getStageIndex();

const spriteWidth = img.width / COLS;
const spriteHeight = img.height / ROWS;

canvas.width = spriteWidth;
canvas.height = spriteHeight;

const sx = (index % COLS) * spriteWidth;
const sy = Math.floor(index / COLS) * spriteHeight;

ctx.clearRect(0,0,canvas.width,canvas.height);

ctx.drawImage(
img,
sx, sy,
spriteWidth, spriteHeight,
0, 0,
spriteWidth, spriteHeight
);
}

function update(){
document.getElementById("stage").innerText=data.stage;
document.getElementById("level").innerText=data.level;
document.getElementById("hp").innerText=data.hp;
document.getElementById("power").innerText=data.power;
document.getElementById("care").innerText=data.care;

draw();
save();
}

function feed(){
data.hp+=10;
data.care++;

if(data.care>5 && data.stage==="Egg") data.stage="Baby";
if(data.level>5 && data.stage==="Baby") data.stage="Rookie";

update();
}

function train(){
data.power+=2;
data.level++;

if(data.level>10 && data.stage==="Rookie") data.stage="Knight";
if(data.level>20 && data.stage==="Knight") data.stage="Dragon";

update();
}

function resetGame(){
localStorage.removeItem("creature");
location.reload();
}

img.onload = function(){
update();
};

img.onerror = function(){
alert("sprite.png ãŒèª­ã¿è¾¼ã‚ã¦ã„ã¾ã›ã‚“ï¼");
};

</script>

</body>
</html>
